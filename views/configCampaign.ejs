<h2>SMS Campaign Configuration</h2>

<%
  var campaignName = '';

  // Campaign Transition config
  var ctmData = '';
  var ctOptin = '';
  var ctOptout = '';

  // Yes/No config
  var ynIncomingPath = '';
  var ynYesPath = '';
  var ynNoPath = '';

  if (typeof config !== 'undefined') {
    campaignName = config.campaign;

    if (typeof config.transitionConfig !== 'undefined') {
      ctmData = config.transitionConfig.mdataId;
      ctOptin = config.transitionConfig.optinPathId;
      ctOptout = config.transitionConfig.optoutCampaignId;
    }

    if (typeof config.yesNoConfig !== 'undefined') {
      ynIncomingPath = config.yesNoConfig.incomingOptInPathId;
      ynYesPath = config.yesNoConfig.yesPath;
      ynNoPath = config.yesNoConfig.noPath;
    }
  }
%>

<form method="post" action="/config/<%= id %>">

<div class="form-section">
  <div class="form-item">
    <label class="field-label">Campaign name:</label>
    <input type="text" class="text-field" name="campaign-name" value="<%= campaignName %>" required>
  </div>
</div>

<div class="form-section">
  <h3>Campaign Transitions</h3>

  <p>
    Configure how the app should handle transitions between Mobile Commons
    campaigns. This is typically setup as an mData that is triggered by a
    keyword and leads to the user subscribing to the main campaign.
  </p>

  <div class="form-item -padded">
    <p>
      This is the mData ID that triggers the campaign transition.
      <a href="https://secure.mcommons.com/mdatas/11713" target="_blank">Example.</a>
    </p>
    <label class="field-label">mData ID:</label>
    <input type="number" class="text-field" name="transition-mdata" value="<%= ctmData %>">
  </div>

  <div class="form-item -padded">
    <p>
      This is the opt-in path ID to subscribe the user to.
      <a href="https://secure.mcommons.com/campaigns/131073/opt_in_paths/174895" target="_blank">
        Example.
      </a>
    </p>
    <label class="field-label">Opt-in Path ID:</label>
    <input type="number" class="text-field" name="transition-optin" value="<%= ctOptin %>">
  </div>

  <div class="form-item -padded">
    <p>
      Not to be mistaken with an opt-in path ID. The value that goes here is the
      ID of the Mobile Commons campaign that the user should be opted out from.
      For this <a href="https://secure.mcommons.com/campaigns/131071" target="_blank">
      example</a>, it would be 131071.
    </p>
    <label class="field-label">Opt-out Campaign ID:</label>
    <input type="number" class="text-field" name="transition-optout" value="<%= ctOptout %>">
  </div>
</div>


<div class="form-section">
  <h3>Yes/No Routing</h3>

  <p>
    As a first step in the SMS report back process, we ask the user if they can
    or cannot send MMS. This determines how we route users based on their response
  </p>

  <div class="form-item -padded">
    <p>
      This is the incoming opt-in path.
      <a href="https://secure.mcommons.com/campaigns/131073/opt_in_paths/174897" target="_blank">
        Example.
      </a>
    </p>
    <label class="field-label">Incoming opt-in path ID:</label>
    <input type="number" class="text-field" name="yesno-incoming-optin" value="<%= ynIncomingPath %>">
  </div>

  <div class="form-item -padded">
    <p>This is the opt-in path to route the user to if they respond with a 'YES'.
      <a href="https://secure.mcommons.com/campaigns/131073/opt_in_paths/174899" target="_blank">
        Example.
      </a>
    </p>
    <label class="field-label">YES opt-in path ID:</label>
    <input type="number" class="text-field" name="yesno-yes-optin" value="<%= ynYesPath %>">
  </div>

  <div class="form-item -padded">
    <p>This is the opt-in path to route the user to if they respond with a 'NO'.
      <a href="https://secure.mcommons.com/campaigns/131073/opt_in_paths/174901" target="_blank">
        Example.
      </a>
    </p>
    <label class="field-label">NO opt-in path ID:</label>
    <input type="number" class="text-field" name="yesno-no-optin" value="<%= ynNoPath %>">
  </div>
</div>

<div class="form-section">
  <h3>Report Backs</h3>

  <p>Some description about this thing.</p>

  <p>[WIP]</p>
</div>

<input type="submit" class="button" value="Submit">

</form>

<% if (id !== 'new') { %>
<div class="form-section">
  <form method="post" action="/config/<%= id %>/delete" onsubmit="return confirm('Are you sure you want to delete this config?')">
    <input type="submit" class="button -secondary" value="Delete">
  </form>
</div>
<% } %>